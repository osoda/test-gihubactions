# This workflow will do a clean installation of node dependencies, cache/restore them, build the source code and run tests across different versions of node
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-nodejs

name: Deploy
on:
  push:
    branches: ["master"]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Use Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20.x
      - name: Debug linux
        run: ls -la

      - name: Setup SSH Agent
        uses: webfactory/ssh-agent@v0.8.0
        with:
          ssh-private-key: |
            -----BEGIN OPENSSH PRIVATE KEY-----
            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
            CgsMDQ==
            -----END OPENSSH PRIVATE KEY-----

      - name: Install dependencies
        run: npm ci

      - name: Run test
        run: npm run test
